<div class="app-component" data-component="home">
<!-- API Configuration Section -->
<div *ngIf="!apiConfigured && !showApiConfig" class="api-setup-section">
	<div class="api-setup-content">
		<h1>ğŸ”§ Setup Required</h1>
		<p class="setup-subtitle">Configure your X/Twitter API credentials to start analyzing sentiment</p>
		
		<div class="setup-info">
			<div class="info-card">
				<div class="info-icon">ğŸ”‘</div>
				<div class="info-text">
					<h3>X/Twitter API Access</h3>
					<p>You need API credentials from <a href="https://developer.twitter.com" target="_blank">developer.twitter.com</a></p>
				</div>
			</div>
			<div class="info-card">
				<div class="info-icon">âš¡</div>
				<div class="info-text">
					<h3>Quick Setup</h3>
					<p>Just your Bearer Token is enough to get started with basic functionality</p>
				</div>
			</div>
		</div>
		
		<button (click)="showApiConfiguration()" class="setup-button">
			ğŸš€ Configure API Credentials
		</button>
	</div>
</div>

<!-- API Configuration Modal -->
<div *ngIf="showApiConfig" class="api-config-modal" (click)="onModalBackgroundClick($event)">
	<div class="api-config-content" (click)="onModalContentClick($event)">
		<div class="modal-header">
			<h2>ğŸ” X/Twitter API Configuration</h2>
			<button type="button" class="close-button" (click)="hideApiConfiguration()" aria-label="Close modal">Ã—</button>
		</div>
		<p class="config-subtitle">Enter your API credentials from developer.twitter.com</p>
		
		<div *ngIf="hasExistingFormData()" class="existing-data-notice">
			ğŸ“ Your previously entered data has been preserved
		</div>
		
		<div class="instructions">
			<div class="instruction-step">
				<span class="step-number">1</span>
				<div class="step-content">
					<strong>Get API Access:</strong> Visit <a href="https://developer.twitter.com" target="_blank">developer.twitter.com</a> and create a developer account
				</div>
			</div>
			<div class="instruction-step">
				<span class="step-number">2</span>
				<div class="step-content">
					<strong>Create App:</strong> Create a new app and generate your Bearer Token
				</div>
			</div>
			<div class="instruction-step">
				<span class="step-number">3</span>
				<div class="step-content">
					<strong>Copy Credentials:</strong> Copy your Bearer Token and paste it below
				</div>
			</div>
		</div>
		
		<form (ngSubmit)="saveApiConfiguration()">
			<div class="config-form">
				<div class="form-group required">
					<label for="bearerToken">Bearer Token *</label>
					<input 
						type="password" 
						id="bearerToken"
						name="bearerToken"
						[(ngModel)]="apiCredentials.bearerToken"
						(input)="onCredentialInput()"
						placeholder="Enter your Bearer Token"
						required
						class="config-input">
					<small>Required for basic functionality</small>
					<div *ngIf="apiCredentialErrors.length" class="validation-errors">
						<small class="error" *ngFor="let err of apiCredentialErrors">{{ err }}</small>
					</div>
				</div>
				
				<div class="optional-section">
					<h4>Optional (for advanced features):</h4>
					
					<div class="form-group">
						<label for="apiKey">API Key</label>
						<input 
							type="password" 
							id="apiKey"
							name="apiKey"
							[(ngModel)]="apiCredentials.apiKey"
							placeholder="Enter your API Key"
							class="config-input">
					</div>
					
					<div class="form-group">
						<label for="apiSecret">API Secret</label>
						<input 
							type="password" 
							id="apiSecret"
							name="apiSecret"
							[(ngModel)]="apiCredentials.apiSecret"
							placeholder="Enter your API Secret"
							class="config-input">
					</div>
					
					<div class="form-group">
						<label for="accessToken">Access Token</label>
						<input 
							type="password" 
							id="accessToken"
							name="accessToken"
							[(ngModel)]="apiCredentials.accessToken"
							placeholder="Enter your Access Token"
							class="config-input">
					</div>
					
					<div class="form-group">
						<label for="accessTokenSecret">Access Token Secret</label>
						<input 
							type="password" 
							id="accessTokenSecret"
							name="accessTokenSecret"
							[(ngModel)]="apiCredentials.accessTokenSecret"
							placeholder="Enter your Access Token Secret"
							class="config-input">
					</div>
				</div>
			</div>
			
			<div class="config-actions">
				<div class="action-left">
					<button 
						*ngIf="hasExistingFormData()" 
						type="button" 
						(click)="resetApiConfiguration()" 
						class="clear-form-button"
						[disabled]="configuringApi">
						ğŸ—‘ï¸ Clear Form
					</button>
				</div>
				<div class="action-right">
					<button type="button" (click)="hideApiConfiguration()" class="cancel-button" [disabled]="configuringApi">
						Cancel
					</button>
					<button type="submit" class="save-button" [disabled]="configuringApi || apiCredentialErrors.length > 0">
						<span *ngIf="configuringApi">â³ Configuring...</span>
						<span *ngIf="!configuringApi">ğŸ’¾ Save Configuration</span>
					</button>
				</div>
			</div>
		</form>
	</div>
</div>

<!-- Topic Search Section -->
<div *ngIf="apiConfigured" class="search-section">
	<div class="section-header">
		<h1>Analyze Topic Sentiment</h1>
		<p class="section-subtitle">Discover public opinion on any topic using machine learning-enhanced sentiment analysis</p>
		
		<div class="api-status">
			<span class="status-badge">âœ… API Configured</span>
			<button (click)="showApiConfiguration()" class="reconfigure-btn">âš™ï¸ Reconfigure</button>
		</div>
	</div>
	
	<!-- Progress Indicator -->
	<div class="progress-steps">
		<div class="step" [class.active]="animationStep >= 1" [class.completed]="animationStep > 1">
			<span class="step-number">1</span>
			<span class="step-label">Enter Topic</span>
		</div>
		<div class="step" [class.active]="animationStep >= 2" [class.completed]="animationStep > 2">
			<span class="step-number">2</span>
			<span class="step-label">Choose Amount</span>
		</div>
		<div class="step" [class.active]="animationStep >= 3" [class.completed]="animationStep > 3">
			<span class="step-number">3</span>
			<span class="step-label">Ready to Search</span>
		</div>
	</div>

	<div class="form-container">
		<form (submit)="fetchTweets($event)">
		<div class="animated-input-group">
			<!-- Step 1: Search Input -->
			<div class="input-container" [class.slide-in]="showSearchInput">
				<input 
					type="text" 
					name="keyword"
					[(ngModel)]="keyword" 
					(input)="onKeywordInput()"
					placeholder="Enter topic, hashtag, or keyword..." 
					required
					[disabled]="!canProceed()"
					class="animated-input">
				<div class="input-helper" *ngIf="!keyword">
					<small>ğŸ’¡ Try: #covid, jakarta, "machine learning"</small>
				</div>
				
				<!-- Next button for Step 1 -->
				<div class="step-buttons" *ngIf="animationStep === 1">
					<button 
						type="button" 
						(click)="proceedToStep2()"
						[disabled]="!canProceedToStep2"
						class="next-button">
						Next: Choose Amount â†’
					</button>
				</div>
			</div>

			<!-- Step 2: Number Input -->
			<div class="input-container" [class.slide-in]="showNumberInput" [class.show]="showNumberInput" *ngIf="showNumberInput">
				<input 
					type="number" 
					name="dataAmount"
					[(ngModel)]="dataAmount" 
					(input)="onDataAmountInput()"
					min="1" 
					max="500" 
					placeholder="Number of tweets" 
					required
					class="animated-input">
				<div class="input-helper" *ngIf="showNumberInput && !dataAmount">
					<small>ğŸ“Š Choose between 1-500 tweets</small>
				</div>
				
				<!-- Navigation buttons for Step 2 -->
				<div class="step-buttons" *ngIf="animationStep === 2">
					<button 
						type="button" 
						(click)="goBackToStep1()"
						class="back-button">
						â† Back: Edit Topic
					</button>
					<button 
						type="button" 
						(click)="proceedToStep3()"
						[disabled]="!canProceedToStep3"
						class="next-button">
						Next: Ready to Search â†’
					</button>
				</div>
			</div>

			<!-- Step 3: Search Button -->
			<div class="button-container" [class.slide-in]="showSearchButton" [class.show]="showSearchButton" *ngIf="showSearchButton">
				<button 
					type="submit" 
					[disabled]="loadingTweets || loadingSentiment || savingToDatabase || !keyword || !dataAmount"
					class="animated-button">
					<span *ngIf="loadingTweets">ğŸ” Fetching...</span>
					<span *ngIf="loadingSentiment">ğŸ¤– Analyzing...</span>
					<span *ngIf="savingToDatabase">ğŸ’¾ Saving...</span>
					<span *ngIf="!loadingTweets && !loadingSentiment && !savingToDatabase">ğŸš€ Analyze Topic</span>
				</button>
				
				<!-- Navigation buttons for Step 3 -->
				<div class="step-buttons" *ngIf="animationStep === 3">
					<button 
						type="button" 
						(click)="goBackToStep2()"
						class="back-button">
						â† Back: Edit Amount
					</button>
					<button 
						type="button" 
						(click)="resetAnimation()"
						class="reset-button">
						ğŸ”„ Start Over
					</button>
				</div>
			</div>
		</div>
		</form>
	</div>

	<!-- Messages -->
	<div *ngIf="errorMsg" class="error-msg animate-in">{{ errorMsg }}</div>
	<div *ngIf="successMsg" class="success-msg animate-in">{{ successMsg }}</div>
	
	<!-- Information Features -->
	<div class="information-features">
		<div class="feature-card">
			<div class="feature-icon">ğŸ¤–</div>
			<div class="feature-text">
				<strong>ML-Enhanced</strong>
				<span>Advanced sentiment analysis using spaCy NLP and Naive Bayes classifier</span>
			</div>
		</div>
		<div class="feature-card">
			<div class="feature-icon">ğŸ“Š</div>
			<div class="feature-text">
				<strong>Real-time Data</strong>
				<span>Live Twitter/X data with instant visualization</span>
			</div>
		</div>
		<div class="feature-card">
			<div class="feature-icon">ğŸ‡®ğŸ‡©</div>
			<div class="feature-text">
				<strong>Indonesian Language</strong>
				<span>Optimized for Bahasa Indonesia processing</span>
			</div>
		</div>
	</div>
</div>

<!-- Results Section -->
<div *ngIf="tweetSentiments.length" class="results-section">
	<h3>Analysis Results for "{{ keyword }}"</h3>
	<div class="stats">
		<span>Total: {{ tweetSentiments.length }} tweets</span>
		<span>Positive: {{ sentimentCounts.positive }}</span>
		<span>Negative: {{ sentimentCounts.negative }}</span>
		<span>Neutral: {{ sentimentCounts.neutral }}</span>
	</div>

	<!-- Sentiment Chart -->
	<div class="chart-container">
		<canvas #sentimentChart id="sentimentChart" width="400" height="200"></canvas>
	</div>

	<!-- Results Table -->
	<div class="table-container">
		<table class="results-table">
			<thead>
				<tr>
					<th>Tweet</th>
					<th>Sentiment</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody>
				<tr *ngFor="let result of tweetSentiments; let i = index" [class]="'sentiment-' + result.sentiment">
					<td>{{ result.text }}</td>
					<td>
						<span class="sentiment-badge" [class]="'badge-' + result.sentiment">
							{{ result.sentiment | titlecase }}
						</span>
					</td>
					<td>
						<button (click)="deleteTweet(i)" class="delete-btn">Delete</button>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>